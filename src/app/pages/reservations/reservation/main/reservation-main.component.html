<form class="form" [formGroup]="formGroup">
  <div class="row w-100">
    <!-- Left Side -->
    <div class="col-md-12 col-xl-5 d-block" *ngIf="reservation?.chargingStation">
      <div class="card card-background mt-0 mb-0">
        <img
          class="front front-background"
          alt="randomImage"
          crossorigin="anonymous"
          [ngStyle]="{ 'background-size': 'contain', 'background-repeat': 'no-repeat' }"
          [src]="siteAreaImage"
          onerror="this.src='/assets/img/theme/no-image.png'"
        />
      </div>
    </div>
    <!-- Right Side -->
    <div class="col-md-12 col-xl-7">
      <div class="form-group" *ngIf="type.value === 'reserve_now'">
        <mat-form-field>
          <mat-hint *ngIf="!expiryDate.value">MM/DD/YYYY --:--</mat-hint>
          <mat-datetimepicker-toggle matSuffix [for]="expiryDatePicker" [disabled]="readOnly">
          </mat-datetimepicker-toggle>
          <mat-datetimepicker
            #expiryDatePicker
            type="datetime"
            [disabled]="readOnly"
            openOnFocus="true"
            timeInterval="5"
            touchUi="true"
          >
          </mat-datetimepicker>
          <input
            matInput
            [formControl]="expiryDate"
            placeholder="{{ 'reservations.dialog.general.expiry_date' | translate }}"
            [matDatetimepicker]="expiryDatePicker"
            [disabled]="readOnly"
            [min]="determineMinDate('expiryDate')"
            autocomplete="false"
            (click)="expiryDatePicker.open()"
            [required]="type.value === 'reserve_now'"
          />
          <mat-error *ngIf="expiryDate.errors?.required">
            {{ 'general.mandatory_field' | translate }}
          </mat-error>
          <mat-error *ngIf="expiryDate.errors?.invalidExpiryDate">
            {{ 'reservations.error.invalid_expiry_date' | translate }}
          </mat-error>
          <mat-error *ngIf="expiryDate.errors?.invalidDate">
            {{ 'reservations.error.invalid_date' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="row" *ngIf="type.value === 'planned_reservation'">
        <div class="col-md-6">
          <div class="form-group">
            <mat-form-field>
              <mat-hint *ngIf="!fromDate.value">MM/DD/YYYY --:--</mat-hint>
              <mat-datetimepicker-toggle matSuffix [for]="fromDatePicker" [disabled]="readOnly">
              </mat-datetimepicker-toggle>
              <mat-datetimepicker
                #fromDatePicker
                type="datetime"
                [disabled]="readOnly"
                openOnFocus="true"
                timeInterval="5"
                touchUi="true"
              >
              </mat-datetimepicker>
              <input
                matInput
                [formControl]="fromDate"
                placeholder="{{ 'reservations.from_date' | translate }}"
                [matDatetimepicker]="fromDatePicker"
                [disabled]="readOnly"
                [min]="determineMinDate('fromDate')"
                autocomplete="false"
                (click)="fromDatePicker.open()"
                [required]="type.value === 'planned_reservation'"
              />
              <mat-error *ngIf="fromDate.errors?.required">
                {{ 'general.mandatory_field' | translate }}
              </mat-error>
              <mat-error *ngIf="fromDate.errors?.invalidDate">
                {{ 'reservations.error.invalid_date' | translate }}
              </mat-error>
              <mat-error *ngIf="fromDate.errors?.invalidDateRange">
                {{ 'reservations.error.invalid_date_range' | translate }}
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="col-md-6">
          <div>
            <mat-form-field>
              <mat-hint *ngIf="!toDate.value">MM/DD/YYYY --:--</mat-hint>
              <mat-datetimepicker-toggle matSuffix [for]="toDatePicker" [disabled]="readOnly">
              </mat-datetimepicker-toggle>
              <mat-datetimepicker
                #toDatePicker
                type="datetime"
                [disabled]="readOnly"
                openOnFocus="true"
                timeInterval="5"
                touchUi="true"
              >
              </mat-datetimepicker>
              <input
                matInput
                [formControl]="toDate"
                placeholder="{{ 'reservations.to_date' | translate }}"
                [matDatetimepicker]="toDatePicker"
                [disabled]="readOnly"
                [min]="determineMinDate('toDate')"
                autocomplete="false"
                (click)="toDatePicker.open()"
                [required]="type.value === 'planned_reservation'"
              />
              <mat-error *ngIf="toDate.errors?.required">
                {{ 'general.mandatory_field' | translate }}
              </mat-error>
              <mat-error *ngIf="toDate.errors?.invalidDate">
                {{ 'reservations.error.invalid_date' | translate }}
              </mat-error>
              <mat-error *ngIf="toDate.errors?.invalidDateRange">
                {{ 'reservations.error.invalid_date_range' | translate }}
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-7">
          <div class="form-group">
            <mat-form-field>
              <input
                matInput
                type="text"
                placeholder="{{ 'reservations.chargingstation_id' | translate }}"
                class="form-field-popup"
                [formControl]="chargingStation"
                [readOnly]="readOnly"
                (click)="assignChargingStation()"
                required
              />
              <button
                *ngIf="chargingStation.value"
                mat-button
                matSuffix
                mat-icon-button
                aria-label="Add"
                [hidden]="readOnly"
                (click)="clearChargingStation()"
              >
                <mat-icon>ev_station</mat-icon>
              </button>
              <mat-error *ngIf="chargingStation.errors?.required">{{
                'general.mandatory_field' | translate
              }}</mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="col-md-5">
          <div class="form-group">
            <mat-form-field>
              <input
                matInput
                type="text"
                placeholder="{{ 'reservations.connector_id' | translate }}"
                class="form-field-popup"
                [disabled]="isChargingStationAvailable()"
                [formControl]="connector"
                [readOnly]="readOnly"
                (click)="assignConnector()"
              />
              <button
                mat-button
                matSuffix
                mat-icon-button
                aria-label="Add"
                [hidden]="readOnly"
                (click)="assignConnector()"
              >
                <mat-icon>power</mat-icon>
              </button>
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="form-group" *ngIf="reservationsAuthorizations?.canListUsers">
        <mat-form-field>
          <input
            matInput
            type="text"
            [readonly]="true"
            placeholder="{{ 'users.title' | translate }}"
            class="form-field-popup"
            (click)="assignUser()"
            [formControl]="user"
            [required]="reservationsAuthorizations?.metadata?.userID?.mandatory"
          />
          <button
            mat-button
            matSuffix
            mat-icon-button
            aria-label="Add"
            [hidden]="readOnly"
            (click)="assignUser()"
          >
            <mat-icon>create</mat-icon>
          </button>
          <mat-error *ngIf="user.errors?.required">
            {{ 'general.mandatory_field' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="form-group" *ngIf="reservationsAuthorizations?.canListTags">
        <mat-form-field>
          <input
            matInput
            type="text"
            [readonly]="true"
            placeholder="{{ 'tags.title' | translate }}"
            class="form-field-popup"
            (click)="assignTag()"
            [formControl]="tag"
            required
          />
          <button
            mat-button
            matSuffix
            mat-icon-button
            aria-label="Add"
            [hidden]="readOnly"
            (click)="assignTag()"
          >
            <mat-icon>create</mat-icon>
          </button>
          <mat-error *ngIf="tag.errors?.required">
            {{ 'general.mandatory_field' | translate }}
          </mat-error>
          <mat-error *ngIf="tag.errors?.inactive">
            {{ 'tags.not_active' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="form-group" *ngIf="isCarComponentActive">
        <mat-form-field>
          <input
            matInput
            type="text"
            [readonly]="true"
            placeholder="{{ 'reservations.car' | translate }}"
            class="form-field-popup"
            (click)="assignCar()"
            [formControl]="car"
          />
          <button
            mat-button
            matSuffix
            mat-icon-button
            aria-label="Add"
            [hidden]="readOnly"
            (click)="assignCar()"
          >
            <mat-icon>directions_car</mat-icon>
          </button>
        </mat-form-field>
      </div>
      <div class="form-group mt-4" *ngIf="reservation?.status">
        <mat-form-field>
          <mat-label for="reservationStatus">{{ 'reservations.status' | translate }}</mat-label>
          <mat-select
            id="reservationStatus"
            [formControl]="status"
            (selectionChange)="onStatusChanged($event)"
          >
            <mat-option *ngFor="let status of reservationStatuses" [value]="status.key">
              {{ status.value | translate }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="status?.errors?.required">{{
            'general.mandatory_field' | translate
          }}</mat-error>
        </mat-form-field>
      </div>
      <div class="form-group mt-4">
        <mat-radio-group [formControl]="type">
          <div *ngFor="let type of reservationTypes" class="mt-2">
            <mat-radio-button value="{{ type.key }}" (change)="onReservationTypeChanged($event)">{{
              type.value | translate
            }}</mat-radio-button>
          </div>
          <mat-error *ngIf="type?.errors?.required">{{
            'general.mandatory_field' | translate
          }}</mat-error>
        </mat-radio-group>
      </div>
    </div>
  </div>
</form>
